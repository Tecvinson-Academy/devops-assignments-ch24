name: Update Submission Board

on:
  schedule:
    - cron:  '0 0 * * *'  # Runs at midnight every day
  push:
    branches:
      - main
permissions:
  contents: write
env:
  GH_TOKEN: ${{ secrets.GH_TOKEN }}
  GITHUB_REPOSITORY: ${{ github.repository }}
  GITHUB_REF: ${{ github.ref }}

jobs:
  check-submissions:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: 3.x

    - name: Install dependencies
      run: pip install PyGithub

    - name: Check Submissions
      run: |
        python scripts/check_submissions.py
        
    - name: Commit and Push Changes
      run: |
        git config --global user.email "tecvinsonbot@tecvinsonacademy.com"
        git config --global user.name "TecVinsonBot"
        git diff --exit-code || (git add README.md; git commit -m "Update README"; git push)
      if: success()
